name: Reassign Issue

on:
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'The issue number to reassign'
        required: true
        type: string
      new_assignee:
        description: 'The GitHub username of the new assignee'
        required: true
        type: string

jobs:
  reassign:
    runs-on: ubuntu-latest
    steps:
      - name: Reassign the issue
        uses: actions/github-script@v6
        with:
          script: |
            // Retrieve the inputs from the workflow_dispatch event
            const issueNumber = parseInt(process.env.INPUT_ISSUE_NUMBER, 10);
            const newAssignee = process.env.INPUT_NEW_ASSIGNEE;
            
            if (isNaN(issueNumber)) {
              core.setFailed("Invalid issue number provided.");
              return;
            }
            
            console.log(Reassigning issue #${issueNumber} to ${newAssignee});
            
            // Update the issue with the new assignee using the GitHub API
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              assignees: [newAssignee]
            });
            
            console.log("Issue reassigned successfully!");
        env:
          INPUT_ISSUE_NUMBER: ${{ github.event.inputs.issue_number }}
          INPUT_NEW_ASSIGNEE: ${{ github.event.inputs.new_assignee }}
