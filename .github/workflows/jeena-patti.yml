name: Reassign Issue

on:
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'The issue number to reassign'
        required: true
        type: string
      new_assignee:
        description: 'The GitHub username of the new assignee'
        required: true
        type: string

jobs:
  reassign:
    runs-on: ubuntu-latest
    permissions:
      issues: write
    steps:
      - name: Reassign the issue
        uses: actions/github-script@v6
        with:
          script: |
            // Retrieve the inputs from the workflow_dispatch event
            const issueNumber = parseInt("${{ github.event.inputs.issue_number }}", 10);
            const newAssignee = "${{ github.event.inputs.new_assignee }}";

            if (isNaN(issueNumber)) {
              throw new Error("Invalid issue number provided.");
            }

            console.log(`Reassigning issue #${issueNumber} to ${newAssignee}`);

            // Update the issue with the new assignee using the GitHub API
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              assignees: [newAssignee]
            });

            console.log("Issue reassigned successfully!");
